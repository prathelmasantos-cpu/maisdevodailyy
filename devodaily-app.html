<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>+DevoDaily - Mais fé, todos os dias</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 400px;
            width: 90%;
            padding: 40px 30px;
        }

        .logo {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo h1 {
            color: #4A90E2;
            font-size: 32px;
            font-weight: bold;
        }

        .logo p {
            color: #666;
            font-size: 14px;
            margin-top: 5px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: #333;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #4A90E2;
        }

        .btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .btn-primary {
            background: #4A90E2;
            color: white;
        }

        .btn-primary:hover {
            background: #357ABD;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 144, 226, 0.4);
        }

        .btn-secondary {
            background: #F39C12;
            color: white;
        }

        .btn-secondary:hover {
            background: #E67E22;
        }

        .link-button {
            display: block;
            text-align: center;
            color: #4A90E2;
            text-decoration: none;
            margin-top: 15px;
            font-size: 14px;
            cursor: pointer;
        }

        .link-button:hover {
            text-decoration: underline;
        }

        .hidden {
            display: none;
        }

        .alert {
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .devotional {
            padding: 20px 0;
        }

        .devotional h2 {
            color: #4A90E2;
            margin-bottom: 15px;
        }

        .verse {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #F39C12;
            margin: 20px 0;
        }

        .verse-text {
            font-style: italic;
            color: #333;
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .verse-reference {
            color: #666;
            font-weight: 600;
            text-align: right;
        }

        .reflection {
            color: #555;
            line-height: 1.8;
            margin: 20px 0;
        }

        .user-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-name {
            font-weight: 600;
            color: #333;
        }

        .user-plan {
            background: #F39C12;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
        }

        @media (max-width: 480px) {
            .container {
                padding: 30px 20px;
            }
            
            .logo h1 {
                font-size: 28px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- LOGO -->
        <div class="logo">
            <h1>+DevoDaily</h1>
            <p>Mais fé, todos os dias</p>
        </div>

        <!-- TELA DE LOGIN -->
        <div id="loginScreen">
            <div id="loginAlert"></div>
            <form id="loginForm">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="loginEmail" placeholder="seu@email.com" required>
                </div>
                <div class="form-group">
                    <label>Senha</label>
                    <input type="password" id="loginPassword" placeholder="••••••••" required>
                </div>
                <button type="submit" class="btn btn-primary">Entrar</button>
            </form>
            <a class="link-button" onclick="showScreen('forgot')">Esqueci minha senha</a>
            <a class="link-button" onclick="showScreen('register')">Criar nova conta</a>
        </div>

        <!-- TELA DE CADASTRO -->
        <div id="registerScreen" class="hidden">
            <div id="registerAlert"></div>
            <form id="registerForm">
                <div class="form-group">
                    <label>Nome Completo</label>
                    <input type="text" id="registerName" placeholder="Seu nome" required>
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="registerEmail" placeholder="seu@email.com" required>
                </div>
                <div class="form-group">
                    <label>Senha</label>
                    <input type="password" id="registerPassword" placeholder="••••••••" minlength="6" required>
                </div>
                <button type="submit" class="btn btn-primary">Criar Conta</button>
            </form>
            <a class="link-button" onclick="showScreen('login')">Já tenho conta</a>
        </div>

        <!-- TELA ESQUECI SENHA -->
        <div id="forgotScreen" class="hidden">
            <div id="forgotAlert"></div>
            <form id="forgotForm">
                <p style="color: #666; margin-bottom: 20px; text-align: center;">
                    Digite seu email para receber instruções de recuperação
                </p>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="forgotEmail" placeholder="seu@email.com" required>
                </div>
                <button type="submit" class="btn btn-primary">Enviar Email</button>
            </form>
            <a class="link-button" onclick="showScreen('login')">Voltar para login</a>
        </div>

        <!-- TELA HOME (Devocional) -->
        <div id="homeScreen" class="hidden">
            <div class="user-info">
                <span class="user-name" id="userName"></span>
                <span class="user-plan" id="userPlan"></span>
            </div>
            
            <div class="devotional">
                <h2 id="devotionalTitle">Devocional do Dia</h2>
                
                <div class="verse">
                    <p class="verse-text" id="verseText"></p>
                    <p class="verse-reference" id="verseReference"></p>
                </div>
                
                <div class="reflection" id="reflectionText"></div>
                
                <button class="btn btn-secondary" onclick="markAsRead()">
                    ✓ Marcar como Lido
                </button>
                
                <button class="btn btn-primary" style="margin-top: 10px;" onclick="logout()">
                    Sair
                </button>
            </div>
        </div>
    </div>

    <script>
        // Configuração da API
        const API_URL = 'http://localhost:3000/api';
        let currentUser = null;

        // Mostrar/esconder telas
        function showScreen(screen) {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('registerScreen').classList.add('hidden');
            document.getElementById('forgotScreen').classList.add('hidden');
            document.getElementById('homeScreen').classList.add('hidden');
            
            document.getElementById(screen + 'Screen').classList.remove('hidden');
        }

        // Mostrar alerta
        function showAlert(screenId, message, type) {
            const alertDiv = document.getElementById(screenId + 'Alert');
            alertDiv.innerHTML = `<div class="alert alert-${type}">${message}</div>`;
            setTimeout(() => alertDiv.innerHTML = '', 5000);
        }

        // LOGIN
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            try {
                const response = await fetch(`${API_URL}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });

                const data = await response.json();

                if (data.success) {
                    currentUser = data.data.user;
                    localStorage.setItem('token', data.data.token);
                    localStorage.setItem('user', JSON.stringify(currentUser));
                    loadHome();
                } else {
                    showAlert('login', data.message, 'error');
                }
            } catch (error) {
                showAlert('login', 'Erro ao conectar com servidor', 'error');
            }
        });

        // CADASTRO
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;

            try {
                const response = await fetch(`${API_URL}/auth/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email, password })
                });

                const data = await response.json();

                if (data.success) {
                    currentUser = data.data.user;
                    localStorage.setItem('token', data.data.token);
                    localStorage.setItem('user', JSON.stringify(currentUser));
                    loadHome();
                } else {
                    showAlert('register', data.message, 'error');
                }
            } catch (error) {
                showAlert('register', 'Erro ao conectar com servidor', 'error');
            }
        });

        // ESQUECI SENHA
        document.getElementById('forgotForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('forgotEmail').value;

            try {
                const response = await fetch(`${API_URL}/auth/forgot-password`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email })
                });

                const data = await response.json();
                showAlert('forgot', 'Email de recuperação enviado com sucesso!', 'success');
                
                setTimeout(() => showScreen('login'), 2000);
            } catch (error) {
                showAlert('forgot', 'Erro ao enviar email', 'error');
            }
        });

        // Carregar tela home
        function loadHome() {
            showScreen('home');
            document.getElementById('userName').textContent = currentUser.name;
            
            const planNames = {
                'free': 'Gratuito',
                'premium_individual': 'Premium',
                'premium_family': 'Família'
            };
            document.getElementById('userPlan').textContent = planNames[currentUser.subscription.plan];
            
            loadDevotional();
        }

        // Carregar devocional (simulado com IA)
        async function loadDevotional() {
            // Em produção, isso virá do backend com IA integrada
            const devotionals = [
                {
                    title: 'A Força da Fé',
                    verse: 'Ora, a fé é a certeza daquilo que esperamos e a prova das coisas que não vemos.',
                    reference: 'Hebreus 11:1',
                    reflection: 'A fé é o fundamento da nossa vida espiritual. Ela nos permite confiar em Deus mesmo quando não compreendemos completamente Seus planos. Hoje, fortaleça sua fé lembrando das vezes em que Deus foi fiel em sua vida. Não deixe que as circunstâncias abalem sua confiança no Senhor.'
                },
                {
                    title: 'O Amor de Deus',
                    verse: 'Porque Deus amou o mundo de tal maneira que deu o seu Filho unigênito, para que todo aquele que nele crê não pereça, mas tenha a vida eterna.',
                    reference: 'João 3:16',
                    reflection: 'O amor de Deus por nós é incondicional e eterno. Não importa o que você tenha feito ou onde você esteja, o amor de Deus sempre estará disponível para você. Hoje, medite nesse amor transformador e permita que ele renove seu coração e sua mente.'
                }
            ];

            const today = new Date().getDate();
            const devotional = devotionals[today % devotionals.length];

            document.getElementById('devotionalTitle').textContent = devotional.title;
            document.getElementById('verseText').textContent = `"${devotional.verse}"`;
            document.getElementById('verseReference').textContent = devotional.reference;
            document.getElementById('reflectionText').textContent = devotional.reflection;
        }

        // Marcar como lido
        function markAsRead() {
            showAlert('home', '✓ Devocional marcado como lido!', 'success');
            // Aqui você faria a chamada à API para registrar
        }

        // Logout
        function logout() {
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            currentUser = null;
            showScreen('login');
        }

        // Verificar se já está logado
        window.onload = () => {
            const token = localStorage.getItem('token');
            const userData = localStorage.getItem('user');
            
            if (token && userData) {
                currentUser = JSON.parse(userData);
                loadHome();
            }
        };
    </script>
</body>
</html>
